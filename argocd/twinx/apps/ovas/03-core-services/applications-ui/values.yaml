# ./argocd/twinx/apps/ovas/03-core-services/applications-ui/values.yaml

# global 섹션에는 다른 앱들과 공통으로 사용하는 설정만 남깁니다.
# ingress.annotations는 applications 섹션으로 이동했으므로 여기서는 제거합니다.
global:
  # 레지스트리 시크릿은 모든 OVAS 앱이 사용하므로 여기에 둡니다.
  imagePullSecrets:
   - name: regcred

applications:
  ingress:
    # =======================================================================
    # 🚨 여기에 'annotations' 블록을 새로 만들어 모든 관련 설정을 위치시킵니다.
    # 이렇게 해야 applications-ui Ingress에 CORS 정책이 올바르게 적용됩니다.
    annotations:
      # Ingress Controller를 NGINX로 지정
      kubernetes.io/ingress.class: "nginx"
      
      # CORS (Cross-Origin Request Blocked) 오류 해결을 위한 설정
      nginx.ingress.kubernetes.io/enable-cors: "true"
      nginx.ingress.kubernetes.io/cors-allow-origin: "*"
      nginx.ingress.kubernetes.io/cors-allow-methods: "GET, POST, OPTIONS, PUT, DELETE"
      nginx.ingress.kubernetes.io/cors-allow-headers: "Content-Type, Authorization"

      # 기타 NGINX 관련 설정
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
    # =======================================================================

    # OVAS의 기본 API 경로
    path: "/cfg/apps"
    pathType: Prefix
    enabled: true

  serviceConfig:
    root_path: ""
    # 위 ingress.path와 이 prefix_url이 일치하는 것이 좋습니다.
    prefix_url: "cfg/apps"

  image:
    repository: "nvcr.io/nvidia/omniverse/kit-appstreaming-applications"
    pullPolicy: Always
    tag: 1.10.1

  applications: {}
  profiles: {}

  monitoring:
    enabled: false
    prometheusNamespace: "monitoring"

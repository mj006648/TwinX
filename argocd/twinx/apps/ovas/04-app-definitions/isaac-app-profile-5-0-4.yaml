# ./argocd/twinx/apps/ovas/04-app-definitions/isaac-app-profile-5-0-4.yaml
apiVersion: omniverse.nvidia.com/v1
kind: ApplicationProfile
metadata:
  name: isaacsim-custom-profile5-0-4
spec:
  name: Isaacsim Custom Profile5-0-4
  description: Updated memory and CPU settings for Isaacsim.
  supportedApplications:
    - name: "isaacsim"
      versions:
        - "5.0.4"
  chartMappings:
    container: streamingKit.image.repository
    container_version: streamingKit.image.tag
    name: streamingKit.name
  chartValues:
    global:
      imagePullSecrets:
        - name: changcred
        - name: regcred
    streamingKit:
      nucleusSecretRef: nucleus-auth
      image:
        repository: docker.io/ich6648/ovas-isaac-sim
        pullPolicy: Always
        tag: '5.0.4'
      command: ["/app/kit/kit"]
      args:
        - --/renderer/multiGpu/enabled=false
        - --/renderer/multiGpu/autoEnable=false
      service:
        type: "LoadBalancer" 
        annotations:
          metallb.universe.tf/address-pool: isaac-sim4-pool
      args:
        - --/rtx/multiGpu/enabled=false
        - --/rtx/renderer/activeGpuId=4
      sessionId: session_id
      name: isaac4
      env:
        - name: NVIDIA_VISIBLE_DEVICES
          value: "4"
      resources:
        requests:
          nvidia.com/gpu: "1"
        limits:
          cpu: "12"
          memory: "48Gi"
          nvidia.com/gpu: "1"

CNPG í—¬ë¦„ ì°¨íŠ¸ì˜ values.yaml êµ¬ì¡° ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ê³ , ì œì‹œí•´ì£¼ì‹  ëª¨ë“  ì„¤ì •ì„ ë°˜ì˜í•œ ìµœì¢… cloudnative-pg-cluster/values.yaml ì „ì²´ ì½”ë“œë¥¼ ì œê³µí•´ ë“œë¦½ë‹ˆë‹¤.

ì´ íŒŒì¼ì€ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤, LoadBalancer ì„œë¹„ìŠ¤, ì„ ì–¸ì  ì—­í• (Roles) ê´€ë¦¬, ê·¸ë¦¬ê³  Nessie DB/User ìƒì„±ì„ CNPG ë°©ì‹ìœ¼ë¡œ ì™„ë²½í•˜ê²Œ êµ¬í˜„í•©ë‹ˆë‹¤.

ğŸ› ï¸ ìˆ˜ì •ëœ CNPG Cluster values.yaml ì „ì²´ ì½”ë“œ
ì´ íŒŒì¼ì€ argocd/twinx/apps/cloudnativepg-cluster/values.yaml ê²½ë¡œì— ì‚¬ìš©ë  ê²ƒì…ë‹ˆë‹¤.

í•µì‹¬ ë³€ê²½ ì‚¬í•­:

cluster.services: ë°°ì—´([])ì—ì„œ ê°ì²´({}) êµ¬ì¡°ë¡œ ìˆ˜ì •í•˜ì—¬ ArgoCD ë Œë”ë§ ì˜¤ë¥˜(Invalid type. Expected: object, given: array)ë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

cluster.roles: nessie_prod_userë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ìƒì„±í•˜ë„ë¡ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

cluster.enablePDB: ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±ì„ ìœ„í•´ falseë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

YAML

# íŒŒì¼ ê²½ë¡œ: argocd/twinx/apps/cloudnativepg-cluster/values.yaml

# -- Override the name of the chart
nameOverride: ""
# -- Override the full name of the chart
fullnameOverride: ""
# -- Override the namespace of the chart
namespaceOverride: ""

###
# -- Type of the CNPG database.
type: postgresql

version:
  # -- PostgreSQL major version to use
  postgresql: "16" 
  # -- If using TimescaleDB, specify the version (ê¸°ë³¸ê°’ ìœ ì§€)
  timescaledb: "2.15"
  # -- If using PostGIS, specify the version (ê¸°ë³¸ê°’ ìœ ì§€)
  postgis: "3.4"

###
# -- Cluster mode of operation.
mode: standalone

recovery: {} # ë³µêµ¬ ëª¨ë“œ ë¹„í™œì„±í™” (ê¸°ë³¸ê°’ ì‚¬ìš©)


# -- í´ëŸ¬ìŠ¤í„° ê¸°ë³¸ ì„¤ì •
cluster:
  # ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ PostgreSQL í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„± (Bitnami standalone ë° readReplicas: false ëŒ€ì‘)
  instances: 1

  # -- ë°ì´í„° ì˜ì†ì„±ì„ ìœ„í•œ PersistentVolumeClaim(PVC) ì„¤ì • (Bitnami persistence ëŒ€ì‘)
  storage:
    size: 10Gi
    storageClass: "rook-ceph-block"

  # -- WAL ì €ì¥ì†Œë¥¼ ë³„ë„ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ë¹„í™œì„±í™”
  walStorage:
    enabled: false
    # size: 1Gi
    # storageClass: ""

  # -- Podì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ë° ìµœëŒ€ ì‚¬ìš©ëŸ‰ ì œí•œ (Bitnami resources ëŒ€ì‘)
  resources:
    limits:
      cpu: "1"
      memory: "1Gi"
    requests:
      cpu: "250m"
      memory: "512Mi"

  # -- Superuser ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬ í™œì„±í™” (CNPG Operatorê°€ Secret ìë™ ìƒì„±)
  enableSuperuserAccess: true
  superuserSecret: "" 

  # -- ì„œë¹„ìŠ¤ ì™¸ë¶€ ë…¸ì¶œ ë°©ì‹ ì„¤ì •: LoadBalancer (ì˜¤ë¥˜ ìˆ˜ì • ì™„ë£Œ)
  # CNPG ì°¨íŠ¸ëŠ” ì´ í•„ë“œë¥¼ 'ê°ì²´'ë¡œ ê¸°ëŒ€í•˜ë©°, ê° ì„œë¹„ìŠ¤ëŠ” ë‚´ë¶€ í‚¤ë¡œ ì •ì˜ë©ë‹ˆë‹¤.
  services:
    # Primary (read-write) ì„œë¹„ìŠ¤ ì„¤ì •: LoadBalancer íƒ€ì… ì ìš©
    primary:
      type: LoadBalancer
    # Read-Only ì„œë¹„ìŠ¤ëŠ” ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì´ë¯€ë¡œ ê¸°ë³¸ê°’(ClusterIP)ì„ ìœ ì§€í•˜ê±°ë‚˜ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    # replica: {} # ì£¼ì„ ì²˜ë¦¬í•˜ë©´ ê¸°ë³¸ ClusterIPê°€ ìƒì„±ë¨

  # -- Pod Disruption Budget (PDB) ë¹„í™œì„±í™” (ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ ì—…ê·¸ë ˆì´ë“œ í¸ì˜ì„±)
  enablePDB: false

  # -- Nessie í”„ë¡œë•ì…˜ ì‚¬ìš©ì ì„ ì–¸ì ìœ¼ë¡œ ìƒì„± (4ë‹¨ê³„ SQL ì‹¤í–‰ì„ ìœ„í•´ í•„ìš”)
  roles:
    - name: nessie_prod_user
      ensure: present
      login: true
      superuser: false

  # -- Nessie ì¹´íƒˆë¡œê·¸ìš© ë°ì´í„°ë² ì´ìŠ¤ ë° ì‚¬ìš©ì ìƒì„± ì„¤ì • (Bitnami auth ëŒ€ì‘)
  initdb:
    # Nessie ì¹´íƒˆë¡œê·¸ìš©ìœ¼ë¡œ ìë™ ìƒì„±í•  ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
    database: nessiedb
    # ìœ„ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ì‚¬ìš©ì ì´ë¦„ (Owner)
    owner: nessie_user 
    # Ownerì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹´ì„ Secret ì´ë¦„. ë¹„ì›Œë‘ë©´ Operatorê°€ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
    secret: ""

# -- ë°±ì—… ì„¤ì • (ê¸°ì¡´ Bitnami ì„¤ì •ì— ì—†ìœ¼ë¯€ë¡œ ë¹„í™œì„±í™”)
backups:
  enabled: false

# -- PgBouncerëŠ” ê¸°ì¡´ ì„¤ì •ì— ì—†ìœ¼ë¯€ë¡œ ë¹„í™œì„±í™” ìœ ì§€
poolers: []
